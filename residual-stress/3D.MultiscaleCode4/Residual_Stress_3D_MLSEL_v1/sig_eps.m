function [sigxx,sigyy,sigxy,sigef,epsxx,epsyy,epsxy,epsef] = sig_eps(numel,numnp,nnpe,nqptv,dndxi,dndet,np,x,y,u,r)% compute the stress and strain from the displacement fieldsigxx = zeros(numel,nqptv);sigyy = zeros(numel,nqptv);sigxy = zeros(numel,nqptv);epsxx = zeros(numel,nqptv);epsyy = zeros(numel,nqptv);epsxy = zeros(numel,nqptv);sigef = zeros(numel,nqptv);epsef = zeros(numel,nqptv);for iele=1:1:numel	         [dndx,dndy,detj] = sfder(iele,nnpe,nqptv,dndxi,dndet,np,x,y);		    for  jqpt=1:1:nqptv		             eexx(jqpt)=0.0;            eeyy(jqpt)=0.0;            eexy(jqpt)=0.0;			        for knpe=1:1:nnpe			               ngnp1=np(iele,knpe);               le1=2*ngnp1;               me1=le1 - 1;               eexx(jqpt) = eexx(jqpt) + dndx(knpe,jqpt)*u(me1);                eeyy(jqpt) = eeyy(jqpt) + dndy(knpe,jqpt)*u(le1);                eexy(jqpt) = eexy(jqpt) + 0.5*(dndx(knpe,jqpt)*u(le1) + dndy(knpe,jqpt)*u(me1));	    end             sigxx(jqpt) = r(1,1)*eexx(jqpt) + r(1,2)*eeyy(jqpt);            sigyy(jqpt) = r(2,1)*eexx(jqpt) + r(2,2)*eeyy(jqpt);            sigxy(jqpt) = r(3,3)*eexy(jqpt);						sigef(iele,jqpt)= sqrt(sigxx(jqpt)*sigxx(jqpt)+sigyy(jqpt)*sigyy(jqpt)+2.0*sigxy(jqpt)*sigxy(jqpt));			eeef(iele,jqpt)= sqrt(eexx(jqpt)*eexx(jqpt)+eeyy(jqpt)*eeyy(jqpt)+2.0*eexy(jqpt)*eexy(jqpt));			    end  end