function [dndx,dndy,dndz,detj] = sfder(iele,nnpe,nqptv,sfac,dndxi,dndet,dndze,np,x,y,z)% compute shape function derivatives detj = zeros(1,nqptv);dndx = zeros(nnpe,nqptv);dndy = zeros(nnpe,nqptv);dndz = zeros(nnpe,nqptv);for i=1:1:nqptv      	  for j=1:1:3           for k=1:1:3             tjac(j,k) = 0.0;          end      end           for j=1:1:nnpe  	      j1=np(iele,j) ;  	        tjac(1,1)=tjac(1,1)+dndxi(j,i)*x(j1);                                 tjac(1,2)=tjac(1,2)+dndet(j,i)*x(j1);	        tjac(1,3)=tjac(1,3)+dndze(j,i)*x(j1);                                tjac(2,1)=tjac(2,1)+dndxi(j,i)*y(j1);                                tjac(2,2)=tjac(2,2)+dndet(j,i)*y(j1);                               tjac(2,3)=tjac(2,3)+dndze(j,i)*y(j1); 	        tjac(3,1)=tjac(3,1)+dndxi(j,i)*z(j1);                                 tjac(3,2)=tjac(3,2)+dndet(j,i)*z(j1);                                tjac(3,3)=tjac(3,3)+dndze(j,i)*z(j1);  	    end                                                                                                                                   detj(i)=det(tjac);	        tjaci = inv(tjac);                                                                                                             for  j=1:1:nnpe	      dndx(j,i)=tjaci(1,1)*dndxi(j,i)+tjaci(2,1)*dndet(j,i)+tjaci(3,1)*dndze(j,i);                  dndy(j,i)=tjaci(1,2)*dndxi(j,i)+tjaci(2,2)*dndet(j,i)+tjaci(3,2)*dndze(j,i);             dndz(j,i)=tjaci(1,3)*dndxi(j,i)+tjaci(2,3)*dndet(j,i)+tjaci(3,3)*dndze(j,i);  end        end 