function [Ksr,Ksc,Ksv,kc] = assmblsurf_ful(ieles,nnps,nps,sek,Ksr,Ksc,Ksv,kc)% assekmbles elemental force and stiffness matrices into global counterpartsfor  i=1:1:nnps	      % Row number in the global stiffness matrix      i6=6*nps(ieles,i);      i5=i6-1;      i4=i5-1;      i3=i4-1;      i2=i3-1;      i1=i2-1;      	     for j=1:1:nnps                        % Column number in the global stiffness matrix          j6=6*nps(ieles,j);          j5=j6-1;          j4=j5-1;          j3=j4-1;          j2=j3-1;          j1=j2-1;          %           for ii=1:1:6%               for jj=1:1:6%                     %                    Ksr(kc)=ir(ii); %                    Ksc(kc)=ic(jj); %                    Ksv(kc)=sek(i,j);%                    kc=kc+1;%                    %               end%           end           Ksr(kc)=i1;            Ksc(kc)=j1;            Ksv(kc)=sek(i,j);           kc=kc+1;           Ksr(kc)=i1;            Ksc(kc)=j2;            Ksv(kc)=sek(i,j+nnps);            kc=kc+1;           Ksr(kc)=i1;            Ksc(kc)=j3;            Ksv(kc)=sek(i,j+2*nnps);            kc=kc+1;           Ksr(kc)=i1;            Ksc(kc)=j4;            Ksv(kc)=sek(i,j+3*nnps);           kc=kc+1;           Ksr(kc)=i1;            Ksc(kc)=j5;            Ksv(kc)=sek(i,j+4*nnps);            kc=kc+1;           Ksr(kc)=i1;            Ksc(kc)=j6;            Ksv(kc)=sek(i,j+5*nnps);            kc=kc+1;                      Ksr(kc)=i2;            Ksc(kc)=j1;           Ksv(kc)=sek(i+nnps,j);             kc=kc+1;           Ksr(kc)=i2;            Ksc(kc)=j2;            Ksv(kc)=sek(i+nnps,j+nnps);            kc=kc+1;           Ksr(kc)=i2;            Ksc(kc)=j3;            Ksv(kc)=sek(i+nnps,j+2*nnps);            kc=kc+1;           Ksr(kc)=i2;            Ksc(kc)=j4;           Ksv(kc)=sek(i+nnps,j+3*nnps);             kc=kc+1;           Ksr(kc)=i2;            Ksc(kc)=j5;            Ksv(kc)=sek(i+nnps,j+4*nnps);            kc=kc+1;           Ksr(kc)=i2;            Ksc(kc)=j6;            Ksv(kc)=sek(i+nnps,j+5*nnps);            kc=kc+1;                            Ksr(kc)=i3;            Ksc(kc)=j1;           Ksv(kc)=sek(i+2*nnps,j);             kc=kc+1;           Ksr(kc)=i3;            Ksc(kc)=j2;            Ksv(kc)=sek(i+2*nnps,j+nnps);            kc=kc+1;           Ksr(kc)=i3;            Ksc(kc)=j3;            Ksv(kc)=sek(i+2*nnps,j+2*nnps);            kc=kc+1;           Ksr(kc)=i3;            Ksc(kc)=j4;           Ksv(kc)=sek(i+2*nnps,j+3*nnps);             kc=kc+1;           Ksr(kc)=i3;            Ksc(kc)=j5;            Ksv(kc)=sek(i+2*nnps,j+4*nnps);            kc=kc+1;           Ksr(kc)=i3;            Ksc(kc)=j6;            Ksv(kc)=sek(i+2*nnps,j+5*nnps);            kc=kc+1;                       Ksr(kc)=i4;            Ksc(kc)=j1;           Ksv(kc)=sek(i+3*nnps,j);             kc=kc+1;           Ksr(kc)=i4;            Ksc(kc)=j2;            Ksv(kc)=sek(i+3*nnps,j+nnps);            kc=kc+1;           Ksr(kc)=i4;            Ksc(kc)=j3;            Ksv(kc)=sek(i+3*nnps,j+2*nnps);            kc=kc+1;           Ksr(kc)=i4;            Ksc(kc)=j4;           Ksv(kc)=sek(i+3*nnps,j+3*nnps);             kc=kc+1;           Ksr(kc)=i4;            Ksc(kc)=j5;            Ksv(kc)=sek(i+3*nnps,j+4*nnps);            kc=kc+1;           Ksr(kc)=i4;            Ksc(kc)=j6;            Ksv(kc)=sek(i+3*nnps,j+5*nnps);            kc=kc+1;                                   Ksr(kc)=i5;            Ksc(kc)=j1;           Ksv(kc)=sek(i+4*nnps,j);             kc=kc+1;           Ksr(kc)=i5;            Ksc(kc)=j2;            Ksv(kc)=sek(i+4*nnps,j+nnps);            kc=kc+1;           Ksr(kc)=i5;            Ksc(kc)=j3;            Ksv(kc)=sek(i+4*nnps,j+2*nnps);            kc=kc+1;           Ksr(kc)=i5;            Ksc(kc)=j4;           Ksv(kc)=sek(i+4*nnps,j+3*nnps);             kc=kc+1;           Ksr(kc)=i5;            Ksc(kc)=j5;            Ksv(kc)=sek(i+4*nnps,j+4*nnps);            kc=kc+1;           Ksr(kc)=i5;            Ksc(kc)=j6;            Ksv(kc)=sek(i+4*nnps,j+5*nnps);            kc=kc+1;                        Ksr(kc)=i6;            Ksc(kc)=j1;           Ksv(kc)=sek(i+5*nnps,j);             kc=kc+1;           Ksr(kc)=i6;            Ksc(kc)=j2;            Ksv(kc)=sek(i+5*nnps,j+nnps);            kc=kc+1;           Ksr(kc)=i6;            Ksc(kc)=j3;            Ksv(kc)=sek(i+5*nnps,j+2*nnps);            kc=kc+1;           Ksr(kc)=i6;            Ksc(kc)=j4;           Ksv(kc)=sek(i+5*nnps,j+3*nnps);             kc=kc+1;           Ksr(kc)=i6;            Ksc(kc)=j5;            Ksv(kc)=sek(i+5*nnps,j+4*nnps);            kc=kc+1;           Ksr(kc)=i6;            Ksc(kc)=j6;            Ksv(kc)=sek(i+5*nnps,j+5*nnps);            kc=kc+1;                  %           %           for k=1:6%               for l=1:6          %                % Find the index at the global stiffness matrix%                 index=find((Ksr==ir(k))&(Ksc==ic(l)));%                % Add the corresponding element%                Ksv(index)=Ksv(index)+sek(nnps*(k-1)+i,nnps*(l-1)+j);%               end%           end  endend