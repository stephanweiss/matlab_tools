function [Qsr,Qsc,Qsv,qc] = assmbl_ful_q_mls(iele,nnpe,ndv,np,qe,Qsr,Qsc,Qsv,qc)% assembles elemental force and stiffness matrices into global counterparts% Size of qe: [(nnpe*6)x(ndv*6)]nnpe2=2*nnpe;for j=1:1:nnpe	       j6=6*np(iele,j);      j5=j6-1;	      j4=j5-1;    j3=j4-1;	      j2=j3-1;    j1=j2-1;      %       k6=6*j;%       k5=k6-1;%       k4=k5-1;%       k3=k4-1;%       k2=k3-1;%       k1=k2-1;          for k=1:1:ndv                  i6=6*k;        i5=i6-1;        i4=i5-1;        i3=i4-1;        i2=i3-1;        i1=i2-1;                               Qsr(qc)=j1;            Qsc(qc)=i1; %            Qsv(qc)=qe(k1,1);           Qsv(qc)=qe(j,i1);           qc=qc+1;           Qsr(qc)=j1;            Qsc(qc)=i2; %            Qsv(qc)=qe(k1,2);            Qsv(qc)=qe(j,i2);           qc=qc+1;           Qsr(qc)=j1;            Qsc(qc)=i3; %            Qsv(qc)=qe(k1,3);            Qsv(qc)=qe(j,i3);           qc=qc+1;           Qsr(qc)=j1;            Qsc(qc)=i4; %            Qsv(qc)=qe(k1,3);            Qsv(qc)=qe(j,i4);           qc=qc+1;           Qsr(qc)=j1;            Qsc(qc)=i5; %            Qsv(qc)=qe(k1,3);            Qsv(qc)=qe(j,i5);           qc=qc+1;           Qsr(qc)=j1;            Qsc(qc)=i6; %            Qsv(qc)=qe(k1,3);            Qsv(qc)=qe(j,i6);           qc=qc+1;                                            Qsr(qc)=j2;            Qsc(qc)=i1; %            Qsv(qc)=qe(k2,1);           Qsv(qc)=qe(j+8,i1);           qc=qc+1;           Qsr(qc)=j2;            Qsc(qc)=i2; %            Qsv(qc)=qe(k2,2);            Qsv(qc)=qe(j+8,i2);           qc=qc+1;           Qsr(qc)=j2;            Qsc(qc)=i3; %            Qsv(qc)=qe(k2,3);            Qsv(qc)=qe(j+8,i3);           qc=qc+1;           Qsr(qc)=j2;            Qsc(qc)=i4; %            Qsv(qc)=qe(k2,3);            Qsv(qc)=qe(j+8,i4);           qc=qc+1;           Qsr(qc)=j2;            Qsc(qc)=i5; %            Qsv(qc)=qe(k2,3);            Qsv(qc)=qe(j+8,i5);           qc=qc+1;           Qsr(qc)=j2;            Qsc(qc)=i6; %            Qsv(qc)=qe(k2,3);            Qsv(qc)=qe(j+8,i6);           qc=qc+1;           	             Qsr(qc)=j3;            Qsc(qc)=i1; %            Qsv(qc)=qe(k3,1);           Qsv(qc)=qe(j+16,i1);           qc=qc+1;           Qsr(qc)=j3;            Qsc(qc)=i2; %            Qsv(qc)=qe(k3,2);            Qsv(qc)=qe(j+16,i2);           qc=qc+1;           Qsr(qc)=j3;            Qsc(qc)=i3; %            Qsv(qc)=qe(k3,3);            Qsv(qc)=qe(j+16,i3);           qc=qc+1;           Qsr(qc)=j3;            Qsc(qc)=i4; %            Qsv(qc)=qe(k3,3);            Qsv(qc)=qe(j+16,i4);           qc=qc+1;           Qsr(qc)=j3;            Qsc(qc)=i5; %            Qsv(qc)=qe(k3,3);            Qsv(qc)=qe(j+16,i5);           qc=qc+1;           Qsr(qc)=j3;            Qsc(qc)=i6; %            Qsv(qc)=qe(k3,3);            Qsv(qc)=qe(j+16,i6);           qc=qc+1;                                 Qsr(qc)=j4;            Qsc(qc)=i1; %            Qsv(qc)=qe(k3,1);           Qsv(qc)=qe(j+24,i1);           qc=qc+1;           Qsr(qc)=j4;            Qsc(qc)=i2; %            Qsv(qc)=qe(k3,2);            Qsv(qc)=qe(j+24,i2);           qc=qc+1;           Qsr(qc)=j4;            Qsc(qc)=i3; %            Qsv(qc)=qe(k3,3);            Qsv(qc)=qe(j+24,i3);           qc=qc+1;           Qsr(qc)=j4;            Qsc(qc)=i4; %            Qsv(qc)=qe(k3,3);            Qsv(qc)=qe(j+24,i4);           qc=qc+1;           Qsr(qc)=j4;            Qsc(qc)=i5; %            Qsv(qc)=qe(k3,3);            Qsv(qc)=qe(j+24,i5);           qc=qc+1;           Qsr(qc)=j4;            Qsc(qc)=i6; %            Qsv(qc)=qe(k3,3);            Qsv(qc)=qe(j+24,i6);           qc=qc+1;                      Qsr(qc)=j5;            Qsc(qc)=i1; %            Qsv(qc)=qe(k3,1);           Qsv(qc)=qe(j+32,i1);           qc=qc+1;           Qsr(qc)=j5;            Qsc(qc)=i2; %            Qsv(qc)=qe(k3,2);            Qsv(qc)=qe(j+32,i2);           qc=qc+1;           Qsr(qc)=j5;            Qsc(qc)=i3; %            Qsv(qc)=qe(k3,3);            Qsv(qc)=qe(j+32,i3);           qc=qc+1;           Qsr(qc)=j5;            Qsc(qc)=i4; %            Qsv(qc)=qe(k3,3);            Qsv(qc)=qe(j+32,i4);           qc=qc+1;           Qsr(qc)=j5;            Qsc(qc)=i5; %            Qsv(qc)=qe(k3,3);            Qsv(qc)=qe(j+32,i5);           qc=qc+1;           Qsr(qc)=j5;            Qsc(qc)=i6; %            Qsv(qc)=qe(k3,3);            Qsv(qc)=qe(j+32,i6);           qc=qc+1;                                 Qsr(qc)=j6;            Qsc(qc)=i1; %            Qsv(qc)=qe(k3,1);           Qsv(qc)=qe(j+40,i1);           qc=qc+1;           Qsr(qc)=j6;            Qsc(qc)=i2; %            Qsv(qc)=qe(k3,2);            Qsv(qc)=qe(j+40,i2);           qc=qc+1;           Qsr(qc)=j6;            Qsc(qc)=i3; %            Qsv(qc)=qe(k3,3);            Qsv(qc)=qe(j+40,i3);           qc=qc+1;           Qsr(qc)=j6;            Qsc(qc)=i4; %            Qsv(qc)=qe(k3,3);            Qsv(qc)=qe(j+40,i4);           qc=qc+1;           Qsr(qc)=j6;            Qsc(qc)=i5; %            Qsv(qc)=qe(k3,3);            Qsv(qc)=qe(j+40,i5);           qc=qc+1;           Qsr(qc)=j6;            Qsc(qc)=i6; %            Qsv(qc)=qe(k3,3);            Qsv(qc)=qe(j+40,i6);           qc=qc+1;                 endend